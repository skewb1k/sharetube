import { createSignal } from "solid-js";
import style from "./VideoInput.module.css";
import { parseVideoUrl } from "./parseVideoUrl";
import { client } from "../lib/client";

export function VideoInput() {
  const [value, setValue] = createSignal("");

  const submit = (e: Event) => {
    e.preventDefault();

    const ytId = parseVideoUrl(value());
    if (!ytId) {
      return;
    }

    client()!.addVideo({ ytId });
    setValue("");
  };

  return (
    <form class={style.bar} onSubmit={submit}>
      <input
        class={style.input}
        type="text"
        placeholder="Enter video link"
        value={value()}
        onInput={(e) => setValue(e.target.value)}
      />
      <button class={style.button} type="submit" disabled={!value().trim()}>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M2 2.8641V9.1411C2.00003 9.22866 2.02305 9.31467 2.06676 9.39054C2.11047 9.46641 2.17334 9.52947 2.24907 9.57341C2.32481 9.61735 2.41075 9.64064 2.49831 9.64093C2.58587 9.64123 2.67197 9.61853 2.748 9.5751L9 6.0021L2.748 2.4301C2.67197 2.38667 2.58587 2.36396 2.49831 2.36426C2.41075 2.36456 2.32481 2.38784 2.24907 2.43178C2.17334 2.47572 2.11047 2.53878 2.06676 2.61465C2.02305 2.69052 2.00003 2.77654 2 2.8641ZM21 5.0001H12C11.7348 5.0001 11.4804 5.10545 11.2929 5.29299C11.1054 5.48053 11 5.73488 11 6.0001C11 6.26531 11.1054 6.51967 11.2929 6.7072C11.4804 6.89474 11.7348 7.0001 12 7.0001H21C21.2652 7.0001 21.5196 6.89474 21.7071 6.7072C21.8946 6.51967 22 6.26531 22 6.0001C22 5.73488 21.8946 5.48053 21.7071 5.29299C21.5196 5.10545 21.2652 5.0001 21 5.0001ZM21 11.0001H9C8.73478 11.0001 8.48043 11.1055 8.29289 11.293C8.10536 11.4805 8 11.7349 8 12.0001C8 12.2653 8.10536 12.5197 8.29289 12.7072C8.48043 12.8947 8.73478 13.0001 9 13.0001H21C21.2652 13.0001 21.5196 12.8947 21.7071 12.7072C21.8946 12.5197 22 12.2653 22 12.0001C22 11.7349 21.8946 11.4805 21.7071 11.293C21.5196 11.1055 21.2652 11.0001 21 11.0001ZM21 17.0001H9C8.73478 17.0001 8.48043 17.1055 8.29289 17.293C8.10536 17.4805 8 17.7349 8 18.0001C8 18.2653 8.10536 18.5197 8.29289 18.7072C8.48043 18.8947 8.73478 19.0001 9 19.0001H21C21.2652 19.0001 21.5196 18.8947 21.7071 18.7072C21.8946 18.5197 22 18.2653 22 18.0001C22 17.7349 21.8946 17.4805 21.7071 17.293C21.5196 17.1055 21.2652 17.0001 21 17.0001Z"
            fill="currentColor"
          />
        </svg>
      </button>
    </form>
  );
}
